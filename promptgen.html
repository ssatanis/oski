<!DOCTYPE html>
<!-- This site was created in Webflow. https://webflow.com --><!-- Last Published: Fri Jun 13 2025 13:52:06 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="tenet-template.webflow.io" data-wf-page="683d91777124b040c4a5b5cd" data-wf-site="683d91777124b040c4a5b5db" lang="en"><head><meta charset="utf-8"><title>PromptGen | Oski</title><meta content="Transform OSCE rubrics into AI-ready prompts with intelligent OCR processing and automated YAML generation." name="description"><meta content="Oski - PromptGen" property="og:title"><meta content="Transform OSCE rubrics into AI-ready prompts with intelligent OCR processing and automated YAML generation." property="og:description"><meta content="images/OskiPreview.png" property="og:image"><meta content="1200" property="og:image:width"><meta content="630" property="og:image:height"><meta content="Oski Preview" property="og:image:alt"><meta content="Oski - PromptGen" property="twitter:title"><meta content="Transform OSCE rubrics into AI-ready prompts with intelligent OCR processing and automated YAML generation." property="twitter:description"><meta content="images/OskiPreview.png" property="twitter:image"><meta property="og:type" content="website"><meta content="summary_large_image" name="twitter:card"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Webflow" name="generator"><link href="https://cdn.prod.website-files.com/683d91777124b040c4a5b5db/css/tenet-template.webflow.shared.40365d26e.css" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"><script src="js/1.6.26-webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Geist:100,200,300,regular,500,600,700,800,900","Prata:regular"]  }});</script><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>

<!-- Dynamic Favicon based on theme -->
<script>
function setFavicon() {
  const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  const favicon = document.querySelector('link[rel="shortcut icon"]') || document.createElement('link');
  favicon.rel = 'shortcut icon';
  favicon.type = 'image/svg+xml';
  favicon.href = isDarkMode ? 'favicons/White.svg' : 'favicons/Black.svg';
  if (!document.querySelector('link[rel="shortcut icon"]')) {
    document.head.appendChild(favicon);
  }
}
setFavicon();
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setFavicon);
</script>

<link href="favicons/683d91777124b040c4a5b5db-683d91777124b040c4a5b63e_logo.png" rel="apple-touch-icon">
<style>
/* Hide Webflow badge */
.w-webflow-badge {
  display: none !important;
}

/* Seamless white gradient background throughout the page */
body {
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
}

.hero, .section {
  background: transparent !important;
}

/* Remove simulation container styling for seamless integration */
.simulation-container {
  width: 100%;
  max-width: none;
  margin: 0;
  padding: 0;
  background: transparent;
  border-radius: 0;
  box-shadow: none;
  position: relative;
  overflow: visible;
}

.simulation-container::before {
  display: none;
}

/* PromptGen Specific Styles - Matching OSCE Video Grader */
.promptgen-container {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    border-radius: 20px;
    padding: 2rem;
    margin: 2rem 0;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
}

.promptgen-grid {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 2rem;
    align-items: start;
}

.config-panel {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 1.5rem;
    border: 1px solid rgba(255,255,255,0.2);
}

.workflow-panel {
    background: rgba(255,255,255,0.95);
    border-radius: 15px;
    padding: 1.5rem;
    color: #333;
}

.input-group {
    margin-bottom: 1.5rem;
}

.input-label {
    display: block;
    color: white;
    font-weight: 600;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.input-field, .select-field {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid rgba(255,255,255,0.3);
    border-radius: 8px;
    background: rgba(255,255,255,0.1);
    color: white;
    font-size: 0.9rem;
    box-sizing: border-box;
}

.input-field::placeholder {
    color: rgba(255,255,255,0.7);
}

.btn-primary {
    background: linear-gradient(135deg, #4CAF50, #81C784);
    color: white;
    border: none;
    padding: 1rem 2rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    margin-top: 1rem;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.btn-secondary {
    background: rgba(255,255,255,0.2);
    color: white;
    border: 1px solid rgba(255,255,255,0.3);
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    margin-top: 0.5rem;
}

.workflow-step {
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    padding: 1rem;
    margin: 0.75rem 0;
    background: #f8f9fa;
    transition: all 0.3s ease;
}

.workflow-step.active {
    border-color: #4CAF50;
    background: #f0f8f0;
    transform: translateX(5px);
}

.workflow-step.completed {
    border-color: #2196F3;
    background: #e3f2fd;
}

.step-title {
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: #333;
}

.step-description {
    font-size: 0.85rem;
    color: #666;
    line-height: 1.4;
}

.file-upload-area {
    border: 2px dashed rgba(255,255,255,0.5);
    border-radius: 10px;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(255,255,255,0.05);
}

.file-upload-area:hover {
    border-color: rgba(255,255,255,0.8);
    background: rgba(255,255,255,0.1);
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: #e0e0e0;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 1rem;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(135deg, #4CAF50, #81C784);
    width: 0%;
    transition: width 0.3s ease;
}

.result-display {
    text-align: center;
    padding: 2rem;
    border-radius: 15px;
    margin: 1rem 0;
    font-size: 1.2rem;
    font-weight: bold;
    background: linear-gradient(135deg, #4CAF50, #81C784);
    color: white;
}

.evidence-card {
    background: #f0f2f6;
    border-left: 4px solid #4CAF50;
    padding: 1rem;
    margin: 0.75rem 0;
    border-radius: 8px;
}

/* Spinning Animation for Shape */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.shape-1 {
    animation: spin 20s linear infinite;
    position: absolute;
    top: 10%;
    right: -150px;
    transform: translateY(-50%);
    z-index: -1;
    opacity: 0.8;
    width: 600px;
    height: auto;
}

.simulation-header {
  text-align: center;
  margin-bottom: 40px;
  position: relative;
  z-index: 1;
}

.simulation-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 16px;
}

.simulation-description {
  font-size: 1.2rem;
  color: #6b7280;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
}

/* Ensure consistent spacing and positioning to match home page exactly */
.hero .max-w-width {
  margin-top: 80px !important; /* Reduced from 120px to bring content higher */
}

/* Make sure the top-text positioning matches home page */
.top-text {
  margin-bottom: 20px;
}

/* Ensure proper spacing between hero and simulation */
#simulation {
  padding-top: 40px !important;
}

/* Make active nav link white with black background */
.navbar-link.w--current {
    background-color: #000000;
    color: #ffffff !important;
    border-radius: 25px;
    padding: 10px 20px;
}

/* Navigation hover effects */
.navbar-link {
    transition: all 0.3s ease;
    padding: 10px 20px;
    border-radius: 25px;
    position: relative;
}

.navbar-link:hover {
    background-color: #000000;
    color: #ffffff !important;
}

@media (max-width: 768px) {
  .promptgen-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .simulation-title {
    font-size: 2rem;
  }
  
  .simulation-description {
    font-size: 1rem;
  }
  
  .hero .max-w-width {
    margin-top: 60px !important;
  }
  
  .shape-1 {
    right: -50px;
  }
}
</style>

</head><body><div class="page-wrapper">
<!-- Centralized Header -->
<div id="header-container"></div>

<section class="hero" id="hero" style="position: relative; overflow: hidden; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%); min-height: 100vh;"><div class="container" style="position: relative; z-index: 2;"><div class="max-w-width" style="margin-top: 80px;"><div data-w-id="cc4bc4b9-3fd8-9621-1de2-e0b7a0bf1285" class="top-text">Interactive Demo</div><h1 data-w-id="6b4f9255-2b7e-e6bc-76d5-b0e49087b85c" class="display-1">Transform OSCE rubrics into <span class="other-font">AI-ready prompts</span>.</h1><div class="margin-20"><p data-w-id="b90b02c7-115c-c062-22d1-a988e276c1cf" class="p-02">Upload rubric documents and convert them into structured YAML prompts with intelligent OCR processing.</p></div><div data-w-id="4c25a1b6-df10-f474-31b4-08ca1d59a136" class="margin-30"><div class="button-flex center-mobile"><a data-w-id="808f99a7-6144-0b76-f91d-d0f0d0481c64" href="#simulation" class="button-first w-inline-block"><div class="txt-wrapper"><div class="button-txt">Get Started</div><div class="button-txt">Get Started</div></div></a></div></div></div></div><img src="images/683d91777124b040c4a5b5db-683f0aa9ed4f9367dd6c8ff1_shape-2.webp" loading="lazy" width="500" sizes="(max-width: 767px) 100vw, 500px" alt="" srcset="https://cdn.prod.website-files.com/683d91777124b040c4a5b5db/683f0aa9ed4f9367dd6c8ff1_shape-2-p-500.webp 500w, https://cdn.prod.website-files.com/683d91777124b040c4a5b5db/683f0aa9ed4f9367dd6c8ff1_shape-2-p-800.webp 800w, https://cdn.prod.website-files.com/683d91777124b040c4a5b5db/683f0aa9ed4f9367dd6c8ff1_shape-2-p-1080.webp 1080w, https://cdn.prod.website-files.com/683d91777124b040c4a5b5db/683f0aa9ed4f9367dd6c8ff1_shape-2.webp 1674w" class="shape-1"></section>

<section id="simulation" style="padding: 40px 0 80px 0;">
  <div class="container">
    <!-- PromptGen Header -->
    <div class="simulation-header" style="text-align: center; margin-bottom: 3rem;">
      <h2 class="simulation-title" style="font-size: 2.5rem; font-weight: 700; color: #1f2937; margin-bottom: 1rem;">üìÑ PromptGen</h2>
      <p class="simulation-description" style="font-size: 1.1rem; color: #6b7280; max-width: 600px; margin: 0 auto;">AI-Powered OCR Processing & YAML Generation Framework</p>
    </div>
    
    <!-- PromptGen Container -->
    <div class="promptgen-container">
      <div class="promptgen-grid">
        <!-- Upload Panel -->
        <div class="config-panel">
          <h3 style="color: white; margin-bottom: 1.5rem; font-size: 1.3rem;">üìÑ Upload Rubric</h3>

          <!-- File Upload Area -->
          <div class="input-group">
            <label class="input-label">üìÅ Select Rubric Document</label>
            <div class="file-upload-area" onclick="document.getElementById('fileInput').click()">
              <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.xls,.xlsx,.txt,.csv,.png,.jpg,.jpeg" style="display: none;" onchange="handleFileUpload(this)">
              <div style="color: white; text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üìÑ</div>
                <p style="margin: 0; font-size: 1.1rem;">Drop your rubric file here</p>
                <p style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin: 0.5rem 0 0 0;">or click to browse</p>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin: 1rem 0 0 0;">Supports PDF, DOC, DOCX, XLS, XLSX, TXT, CSV, and images</p>
              </div>
            </div>
            <div id="filePreview" style="margin-top: 1rem; display: none;">
              <div id="fileInfo" style="color: white; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 1rem;"></div>
            </div>
          </div>



          <!-- Action Buttons -->
          <button class="btn-primary" onclick="processRubric()" id="processBtn" disabled>
            üöÄ Process Rubric
          </button>
          <button class="btn-secondary" onclick="resetProcess()">
            üîÑ Reset
          </button>
        </div>

        <!-- Results Panel -->
        <div class="workflow-panel">
          <h3 style="color: #333; margin-bottom: 1.5rem; font-size: 1.3rem;">üìã Processing Results</h3>

          <!-- Progress Bar -->
          <div id="progressContainer" style="display: none;">
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <p id="progressText" style="text-align: center; color: #666; margin: 0.5rem 0;">Ready to process rubric...</p>
          </div>

          <!-- Processing Steps -->
          <div id="step-upload" class="workflow-step">
            <div class="step-title">üì§ 1. File Upload</div>
            <div class="step-description">Upload and validate the rubric document</div>
          </div>

          <div id="step-ocr" class="workflow-step">
            <div class="step-title">üëÅÔ∏è 2. OCR Processing</div>  
            <div class="step-description">Extract text content using advanced OCR</div>
          </div>

          <div id="step-analysis" class="workflow-step">
            <div class="step-title">üß† 3. AI Analysis</div>
            <div class="step-description">Analyze rubric structure and content</div>
          </div>

          <div id="step-generation" class="workflow-step">
            <div class="step-title">‚ö° 4. YAML Generation</div>
            <div class="step-description">Generate structured YAML prompts</div>
          </div>

          <div id="step-validation" class="workflow-step">
            <div class="step-title">‚úÖ 5. Validation</div>
            <div class="step-description">Validate and optimize the output</div>
          </div>

          <!-- Results Container -->
          <div id="resultsContainer" style="display: none; margin-top: 2rem;">
            <div class="evidence-card">
              <h4 style="margin-bottom: 0.5rem; color: #333;">üìä Processing Summary</h4>
              <p id="processingStats" style="margin: 0; color: #555; line-height: 1.5;">Processing statistics will appear here...</p>
            </div>
            
            <div class="evidence-card">
              <h4 style="margin-bottom: 0.5rem; color: #333;">üìù Generated YAML</h4>
              <div style="background: #1e1e1e; border-radius: 8px; padding: 1rem; margin-top: 0.5rem;">
                <pre id="yamlOutput" style="color: #d4d4d4; font-family: 'Courier New', monospace; font-size: 0.8rem; margin: 0; white-space: pre-wrap; word-wrap: break-word; max-height: 300px; overflow-y: auto;"></pre>
              </div>
              <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                <button onclick="downloadYaml()" style="background: #4CAF50; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem;">
                  üì• Download YAML
                </button>
                <button onclick="copyYaml()" style="background: #2196F3; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem;">
                  üìã Copy to Clipboard
                </button>
                <button onclick="editYaml()" style="background: #FF9800; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem;">
                  ‚úèÔ∏è Edit YAML
                </button>
              </div>
            </div>
            
            <div class="evidence-card">
              <h4 style="margin-bottom: 0.5rem; color: #333;">üìÑ Original Text</h4>
              <div style="max-height: 200px; overflow-y: auto; background: #f8f9fa; padding: 1rem; border-radius: 6px; font-size: 0.85rem; line-height: 1.4;">
                <p id="originalText" style="margin: 0; color: #333;"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    

  </div>
</section>

<!-- Centralized Footer -->
<div id="footer-container"></div>

</div>

<!-- Load centralized header and footer -->
<script src="js/header.js"></script>
<script src="js/footer.js"></script>

<!-- PromptGen Functionality -->
<script>
// Global variables
let selectedFile = null;
let processingInProgress = false;
let currentTaskId = null;

// File upload handling
function handleFileUpload(input) {
    const file = input.files[0];
    if (file) {
        selectedFile = file;
        const filePreview = document.getElementById('filePreview');
        const fileInfo = document.getElementById('fileInfo');
        const processBtn = document.getElementById('processBtn');
        
        // Display file info
        const fileSize = (file.size / 1024 / 1024).toFixed(2);
        fileInfo.innerHTML = `
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <strong>üìÑ ${file.name}</strong><br>
                    <small>Size: ${fileSize} MB | Type: ${file.type || 'Unknown'}</small>
                </div>
                <div style="color: #4CAF50; font-size: 1.5rem;">‚úÖ</div>
            </div>
        `;
        
        filePreview.style.display = 'block';
        processBtn.disabled = false;
        processBtn.style.opacity = '1';
    }
}

// Process rubric
async function processRubric() {
    if (!selectedFile || processingInProgress) {
        return;
    }
    
    processingInProgress = true;
    
    // Show progress container
    const progressContainer = document.getElementById('progressContainer');
    progressContainer.style.display = 'block';
    
    // Reset all workflow steps
    const steps = ['upload', 'ocr', 'analysis', 'generation', 'validation'];
    steps.forEach(step => {
        const element = document.getElementById(`step-${step}`);
        element.classList.remove('active', 'completed');
    });
    
    // Hide results
    document.getElementById('resultsContainer').style.display = 'none';
    
    // Start real processing
    await startRealProcessing();
}

// Real processing function
async function startRealProcessing() {
    try {
        // Step 1: File Upload
        updateStep('upload', 'active');
        document.getElementById('progressText').textContent = 'Uploading file to server...';
        document.getElementById('progressFill').style.width = '20%';
        
        const formData = new FormData();
        formData.append('file', selectedFile);
        
        const uploadResponse = await fetch('http://localhost:8000/upload-rubric', {
            method: 'POST',
            body: formData
        });
        
        if (!uploadResponse.ok) {
            const errorText = await uploadResponse.text();
            console.error('Upload failed:', errorText);
            throw new Error(`Upload failed: ${uploadResponse.status} ${uploadResponse.statusText}`);
        }
        
        const uploadResult = await uploadResponse.json();
        currentTaskId = uploadResult.task_id;
        
        updateStep('upload', 'completed');
        
        // Start polling for status
        await pollProcessingStatus();
        
    } catch (error) {
        console.error('Processing error:', error);
        let errorMessage = 'Processing failed';
        
        if (error.message.includes('fetch')) {
            errorMessage = 'Connection failed. Please check if the backend server is running.';
        } else if (error.message.includes('CORS')) {
            errorMessage = 'CORS error. Please check server configuration.';
        } else {
            errorMessage = 'Processing failed: ' + error.message;
        }
        
        document.getElementById('progressText').textContent = errorMessage;
        processingInProgress = false;
        
        // Reset workflow steps
        const steps = ['upload', 'ocr', 'analysis', 'generation', 'validation'];
        steps.forEach(step => {
            const element = document.getElementById(`step-${step}`);
            element.classList.remove('active', 'completed');
        });
    }
}

// Poll processing status
async function pollProcessingStatus() {
    try {
        const response = await fetch(`http://localhost:8000/status/${currentTaskId}`);
        const data = await response.json();
        
        // Update progress based on step
        if (data.step === 'ocr_processing') {
            updateStep('ocr', 'active');
            document.getElementById('progressText').textContent = 'Extracting text with advanced OCR...';
            document.getElementById('progressFill').style.width = '40%';
        } else if (data.step === 'ai_analysis') {
            updateStep('ocr', 'completed');
            updateStep('analysis', 'active');
            document.getElementById('progressText').textContent = 'Analyzing rubric structure with AI...';
            document.getElementById('progressFill').style.width = '60%';
        } else if (data.step === 'yaml_generation') {
            updateStep('analysis', 'completed');
            updateStep('generation', 'active');
            document.getElementById('progressText').textContent = 'Generating structured YAML prompts...';
            document.getElementById('progressFill').style.width = '80%';
        } else if (data.step === 'validation') {
            updateStep('generation', 'completed');
            updateStep('validation', 'active');
            document.getElementById('progressText').textContent = 'Validating and optimizing output...';
            document.getElementById('progressFill').style.width = '90%';
        }
        
        if (data.status === 'completed' && data.result) {
            updateStep('validation', 'completed');
            document.getElementById('progressFill').style.width = '100%';
            document.getElementById('progressText').textContent = 'Processing completed successfully!';
            showRealResults(data.result);
        } else if (data.status === 'error') {
            throw new Error(data.error || 'Processing failed');
        } else {
            // Continue polling
            setTimeout(() => pollProcessingStatus(), 2000);
        }
    } catch (error) {
        console.error('Status polling error:', error);
        let errorMessage = 'Status check failed';
        
        if (error.message.includes('fetch') || error.name === 'TypeError') {
            errorMessage = 'Connection lost. Please check if the backend server is running.';
        } else {
            errorMessage = 'Processing failed: ' + error.message;
        }
        
        document.getElementById('progressText').textContent = errorMessage;
        processingInProgress = false;
        
        // Reset workflow steps
        const steps = ['upload', 'ocr', 'analysis', 'generation', 'validation'];
        steps.forEach(step => {
            const element = document.getElementById(`step-${step}`);
            element.classList.remove('active', 'completed');
        });
    }
}

// Update workflow step
function updateStep(stepId, status) {
    const element = document.getElementById(`step-${stepId}`);
    element.classList.remove('active', 'completed');
    if (status) {
        element.classList.add(status);
    }
}

// Simulate processing workflow
function simulateProcessing() {
    const steps = [
        { id: 'upload', name: 'File Upload', duration: 2000, message: 'Uploading and validating file...' },
        { id: 'ocr', name: 'OCR Processing', duration: 4000, message: 'Extracting text from document...' },
        { id: 'analysis', name: 'AI Analysis', duration: 3000, message: 'Analyzing rubric structure...' },
        { id: 'generation', name: 'YAML Generation', duration: 3000, message: 'Generating YAML prompts...' },
        { id: 'validation', name: 'Validation', duration: 2000, message: 'Validating output format...' }
    ];
    
    let currentStep = 0;
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    
    function processStep() {
        if (currentStep >= steps.length) {
            // Processing complete
            showResults();
            return;
        }
        
        const step = steps[currentStep];
        const element = document.getElementById(`step-${step.id}`);
    
    // Mark current step as active
        element.classList.add('active');
        progressText.textContent = step.message;
    
        // Update progress bar
        const progress = ((currentStep + 1) / steps.length) * 100;
    progressFill.style.width = `${progress}%`;
        
        setTimeout(() => {
            // Mark step as completed
            element.classList.remove('active');
            element.classList.add('completed');
            
            currentStep++;
            processStep();
        }, step.duration);
    }
    
    processStep();
}

// Show real processing results
function showRealResults(result) {
    const resultsContainer = document.getElementById('resultsContainer');
    const processingStats = document.getElementById('processingStats');
    const yamlOutput = document.getElementById('yamlOutput');
    const originalText = document.getElementById('originalText');
    
    // Generate processing stats
    const fileSize = (selectedFile.size / 1024 / 1024).toFixed(2);
    const textLength = result.original_text ? result.original_text.length : 0;
    processingStats.innerHTML = `
        <strong>File:</strong> ${selectedFile.name} (${fileSize} MB)<br>
        <strong>OCR Quality:</strong> High Quality (Advanced)<br>
        <strong>AI Model:</strong> OpenAI GPT-4 Turbo<br>
        <strong>Output Format:</strong> YAML (Structured)<br>
        <strong>Processing Time:</strong> ${result.processing_time || 'N/A'}s<br>
        <strong>Text Extracted:</strong> ${textLength} characters<br>
        <strong>YAML Validation:</strong> ‚úÖ Passed
    `;
    
    // Display the generated YAML (clean, without header comments)
    yamlOutput.textContent = result.yaml_content || 'No YAML generated';
    
    // Display original extracted text
    originalText.textContent = result.original_text || 'No text extracted';
    
    resultsContainer.style.display = 'block';
    processingInProgress = false;
}

// Generate sample YAML based on rubric
function generateSampleYaml() {
    const aiModel = document.getElementById('aiModel').value;
    const fileName = selectedFile ? selectedFile.name.replace(/\.[^/.]+$/, '') : 'rubric';
    
    return `# Generated YAML Prompt for ${fileName}
# AI Model: ${aiModel}
# Generated: ${new Date().toISOString()}

rubric_title: "Student Performance Assessment Rubric"
rubric_type: "medical_education"
total_points: 100

categories:
  communication_skills:
    weight: 25
    description: "Evaluation of student's communication abilities"
    criteria:
      excellent:
        points: "22-25"
        description: "Clear, professional communication with appropriate medical terminology"
        indicators:
          - "Uses precise medical language"
          - "Demonstrates active listening"
          - "Provides clear explanations to patients"
      good:
        points: "18-21"
        description: "Generally clear communication with minor issues"
        indicators:
          - "Mostly appropriate language use"
          - "Occasional communication gaps"
      satisfactory:
        points: "14-17"
        description: "Adequate communication with some unclear areas"
        indicators:
          - "Basic communication skills"
          - "Some difficulty with complex explanations"
      needs_improvement:
        points: "0-13"
        description: "Poor communication affecting patient interaction"
        indicators:
          - "Unclear or inappropriate communication"
          - "Difficulty establishing rapport"

  clinical_knowledge:
    weight: 30
    description: "Assessment of medical knowledge application"
    criteria:
      comprehensive:
        points: "26-30"
        description: "Demonstrates comprehensive understanding"
        indicators:
          - "Accurate knowledge application"
          - "Evidence-based decision making"
      proficient:
        points: "21-25"
        description: "Good knowledge with minor gaps"
      developing:
        points: "16-20"
        description: "Basic knowledge with some limitations"
      inadequate:
        points: "0-15"
        description: "Insufficient knowledge for safe practice"

  patient_interaction:
    weight: 25
    description: "Evaluation of patient relationship skills"
    criteria:
      exemplary:
        points: "23-25"
        description: "Shows empathy and professionalism"
        indicators:
          - "Demonstrates cultural sensitivity"
          - "Maintains appropriate boundaries"
      competent:
        points: "18-22"
        description: "Generally appropriate interactions"
      basic:
        points: "13-17"
        description: "Minimal interaction skills"
      inadequate:
        points: "0-12"
        description: "Poor patient interaction"

  technical_skills:
    weight: 20
    description: "Assessment of practical skills"
    criteria:
      expert:
        points: "18-20"
        description: "Performs procedures correctly and safely"
      proficient:
        points: "14-17"
        description: "Good technical skills with minor issues"
      developing:
        points: "10-13"
        description: "Basic skills requiring supervision"
      inadequate:
        points: "0-9"
        description: "Unsafe or incorrect technique"

assessment_instructions:
  - "Observe student performance throughout the clinical encounter"
  - "Rate each category based on demonstrated competency"
  - "Provide specific feedback for improvement areas"
  - "Consider patient safety in all assessments"

scoring_guide:
  total_points_possible: 100
  grade_scale:
    A: "90-100 points"
    B: "80-89 points"
    C: "70-79 points"
    D: "60-69 points"
    F: "Below 60 points"`;
}

// Download YAML
async function downloadYaml() {
    if (!currentTaskId) {
        alert('‚ùå No YAML available for download');
        return;
    }
    
    try {
        const response = await fetch(`http://localhost:8000/download-yaml/${currentTaskId}`, {
            method: 'GET'
        });
        
        if (!response.ok) {
            throw new Error('Download failed');
        }
        
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        const fileName = selectedFile ? selectedFile.name.replace(/\.[^/.]+$/, '') : 'rubric';
        a.download = `${fileName}_prompt.yaml`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        alert('‚úÖ YAML file downloaded successfully!');
    } catch (error) {
        console.error('Download error:', error);
        alert('‚ùå Download failed: ' + error.message);
    }
}

// Copy YAML to clipboard
function copyYaml() {
    const yamlContent = document.getElementById('yamlOutput').textContent;
    navigator.clipboard.writeText(yamlContent).then(() => {
        alert('üìã YAML content copied to clipboard!');
    }).catch(() => {
        alert('‚ùå Failed to copy to clipboard');
    });
}

// Edit YAML functionality
function editYaml() {
    const yamlOutput = document.getElementById('yamlOutput');
    const currentYaml = yamlOutput.textContent;
    
    // Create edit modal
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
    `;
    
    const modalContent = document.createElement('div');
    modalContent.style.cssText = `
        background: white;
        border-radius: 15px;
        padding: 2rem;
        width: 90%;
        max-width: 800px;
        max-height: 80%;
        overflow-y: auto;
    `;
    
    modalContent.innerHTML = `
        <h3 style="margin-top: 0; color: #333;">‚úèÔ∏è Edit YAML Prompt</h3>
        <textarea id="yamlEditor" style="
            width: 100%;
            height: 400px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            resize: vertical;
            background: #f8f9fa;
        ">${currentYaml}</textarea>
        <div style="margin-top: 1rem; text-align: right;">
            <button onclick="cancelEdit()" style="
                background: #6c757d;
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
                cursor: pointer;
                margin-right: 1rem;
            ">Cancel</button>
            <button onclick="saveEdit()" style="
                background: #4CAF50;
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
                cursor: pointer;
            ">Save Changes</button>
        </div>
    `;
    
    modal.appendChild(modalContent);
    document.body.appendChild(modal);
    window.currentEditModal = modal;
}

// Cancel edit
function cancelEdit() {
    if (window.currentEditModal) {
        document.body.removeChild(window.currentEditModal);
        window.currentEditModal = null;
    }
}

// Save edit
async function saveEdit() {
    const yamlEditor = document.getElementById('yamlEditor');
    const editedYaml = yamlEditor.value;
    
    if (!currentTaskId) {
        alert('‚ùå No task ID available for saving');
        return;
    }
    
    try {
        const response = await fetch(`http://localhost:8000/update-yaml/${currentTaskId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                yaml_content: editedYaml
            })
        });
        
        if (!response.ok) {
            throw new Error('Failed to save changes');
        }
        
        // Update the display
        document.getElementById('yamlOutput').textContent = editedYaml;
        
        // Close modal
        cancelEdit();
        
        alert('‚úÖ YAML updated successfully!');
    } catch (error) {
        console.error('Save error:', error);
        alert('‚ùå Failed to save changes: ' + error.message);
    }
}

// Reset process
function resetProcess() {
    selectedFile = null;
    processingInProgress = false;
    currentTaskId = null;
    
    // Clear file input
    document.getElementById('fileInput').value = '';
    
    // Hide file preview
    document.getElementById('filePreview').style.display = 'none';
    
    // Disable process button
    const processBtn = document.getElementById('processBtn');
    processBtn.disabled = true;
    processBtn.style.opacity = '0.5';
    
    // Hide progress and results
    document.getElementById('progressContainer').style.display = 'none';
    document.getElementById('resultsContainer').style.display = 'none';
    
    // Reset all workflow steps
    const steps = ['upload', 'ocr', 'analysis', 'generation', 'validation'];
    steps.forEach(step => {
        const element = document.getElementById(`step-${step}`);
        element.classList.remove('active', 'completed');
    });
    
    // Reset progress bar
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    progressFill.style.width = '0%';
    progressText.textContent = 'Ready to process rubric...';
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Disable process button initially
    const processBtn = document.getElementById('processBtn');
    processBtn.style.opacity = '0.5';
});
</script>

<!-- Webflow animations -->
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=683d91777124b040c4a5b5db" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="js/webflow.js" type="text/javascript"></script>

</body></html> 